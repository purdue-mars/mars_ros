<launch>
    <arg name="ips" default="{pan_pan/robot_ip: 172.16.1.2, an_an/robot_ip: 172.18.1.2}"/>
    <arg name="root_id" default="combined_arms" />

    <rosparam file="$(find mars_config)/config/robot_config.yml" command="load" subst_value="true" />

    <group ns="$(arg root_id)">
        <rosparam command="load" file="$(find icra18)/config/controllers.yaml" /> 
        <include file="$(find dual_mars_arm_moveit_config)/launch/move_group.launch"/>
        <node pkg="rviz" type="rviz" name="rviz" args="-d $(find mars_launch)/rviz/dual_config.rviz" />
        <node pkg="mars_control" name="panda_planning_server" type="planning_server" output="screen">
            <param name="combined_planning_group" value="$(arg robot_id)" />
        </node>
        <include file="$(find mars_gripper)/launch/gripper.launch">
            <arg name="robot_id" value="pan_pan" />
        </include>
        <include file="$(find mars_gripper)/launch/gripper.launch">
            <arg name="robot_id" value="an_an" />
        </include>
    </group>

    <include file="$(find franka_control)/launch/mars_combined_control.launch">
        <arg name="robot_ips" value="$(arg ips)"/>
        <arg name="robot_id" value="$(arg root_id)" />
    </include>

    <group ns="perception">
        <include file="$(find mars_launch)/launch/perception.launch">
            <arg name="robot_id" value="pan_pan" />
        </include>
    </group>
</launch>